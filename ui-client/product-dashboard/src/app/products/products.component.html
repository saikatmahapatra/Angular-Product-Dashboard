<h2>{{title}}</h2>
<div *ngIf="isLoading" style="position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);">
  <mat-spinner></mat-spinner>
</div>

<ng-container *ngIf="!isDetailView">
  <div class="row">
    <div class="col-md-12 mb-3">
      <div class="filters">
        <select [(ngModel)]="filters.category" (change)="loadProducts()">
          <option [value]="undefined">All Categories</option>
          <option *ngFor="let cat of categories" [value]="cat.id">
            {{cat.name}}
          </option>
        </select>

      </div>
    </div>
  </div>
  <div class="row" *ngIf="!isLoading">
    <!-- featured -->
    <!-- <div class="col-md-4 mb-3" *ngFor="let product of featuredProducts">
      <mat-card class="product-card" appearance="outlined">
        <mat-card-header>
          <mat-card-title>{{product?.title | slice:0:25}}...</mat-card-title>
          <mat-card-subtitle>{{product?.category_name}}</mat-card-subtitle>
        </mat-card-header>
        <img mat-card-image [attr.src]="product?.image_url" alt="{{product?.title}}" class="list-img">
        <mat-card-content>
          <p>
            {{product?.description | slice:0:50}}...
          </p>
        </mat-card-content>
        <mat-card-actions>
          <button mat-raised-button class="me-2" color="secondary"
            (click)="viewProductDetails(product.id)">Details</button>
          <button mat-raised-button color="primary" (click)="addToCart(product.id, 1)">Add to cart</button>
        </mat-card-actions>
      </mat-card>
    </div> -->
    <!-- featured -->
     
    <div class="col-md-3 mb-3" *ngFor="let product of products">
      <mat-card class="product-card" appearance="outlined">
        <mat-card-header>
          <mat-card-title>{{product?.title | slice:0:25}}...</mat-card-title>
          <mat-card-subtitle>{{product?.category_name}}</mat-card-subtitle>
        </mat-card-header>
        <img mat-card-image [attr.src]="product?.image_url" alt="{{product?.title}}" class="list-img">
        <mat-card-content>
          <p>
            {{product?.description | slice:0:50}}...
          </p>
        </mat-card-content>
        <mat-card-actions>
          <button mat-raised-button class="me-2" color="secondary"
            (click)="viewProductDetails(product.id)">Details</button>
          <button mat-raised-button color="primary" (click)="addToCart(product.id, 1)">Add to cart</button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
  <mat-paginator #paginator (page)="pageChangeEvent($event)" [length]="totalRecords" [pageSize]="itemPerPage"
    [pageIndex]="pageIndex" [length]="totalRecords" showFirstLastButtons>
  </mat-paginator>
</ng-container>

<ng-container *ngIf="isDetailView">
  <div class="col-md-6 mb-3">
    <mat-card class="product-card" appearance="outlined">
      <mat-card-header>
        <mat-card-title>{{productDetails[0].title}}</mat-card-title>
        <mat-card-subtitle>{{productDetails[0].category_name}}</mat-card-subtitle>
      </mat-card-header>
      <img mat-card-image [attr.src]="productDetails[0].image_url" alt="{{productDetails[0].title}}">
      <mat-card-content>
        <p>
          {{productDetails[0].description}}
        </p>
      </mat-card-content>
      <mat-card-actions>
        <button mat-raised-button class="me-2" color="secondary"
          (click)="backToList()">Back</button>
        <button mat-raised-button color="primary" (click)="addToCart(productDetails[0].id, 1)">Add to cart</button>
      </mat-card-actions>
    </mat-card>
  </div>
</ng-container>